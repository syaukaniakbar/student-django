{% extends 'base.html' %}

{% block title %}Hasil Pencarian{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Hasil Pencarian</h2>
    
    <!-- Search Form -->
    <form method="get" class="mb-4">
        <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Cari mahasiswa berdasarkan nama, NIM, jurusan, kota, atau fakultas..." 
                   value="{{ request.GET.q }}" autocomplete="off">
            <button class="btn btn-primary" type="submit">Cari</button>
        </div>
    </form>

    {% if request.GET.q %}
        <p>Menampilkan hasil untuk: <strong>{{ request.GET.q }}</strong></p>
        {% if results %}
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>NIM</th>
                            <th>Nama Lengkap</th>
                            <th>Email</th>
                            <th>Fakultas</th>
                            <th>Jurusan</th>
                            <th>Angkatan</th>
                            <th>IPK</th>
                            <th>Status</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for m in results %}
                        <tr>
                            <td><a href="{% url 'mahasiswa_detail' m.nim %}">{{ m.nim }}</a></td>
                            <td><a href="{% url 'mahasiswa_detail' m.nim %}">{{ m.nama_lengkap }}</a></td>
                            <td>{{ m.email }}</td>
                            <td>{{ m.fakultas }}</td>
                            <td>{{ m.jurusan }}</td>
                            <td>{{ m.angkatan }}</td>
                            <td>{{ m.ipk }}</td>
                            <td>
                                <span class="badge 
                                    {% if m.status == 'Aktif' %}bg-success
                                    {% elif m.status == 'Lulus' %}bg-info
                                    {% elif m.status == 'Cuti' %}bg-warning
                                    {% elif m.status == 'Drop Out' %}bg-danger
                                    {% endif %}">
                                    {{ m.status }}
                                </span>
                            </td>
                            <td>
                                <a href="{% url 'mahasiswa_update' m.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
                                <a href="{% url 'mahasiswa_delete' m.pk %}" class="btn btn-sm btn-outline-danger">Hapus</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <p class="text-muted">Ditemukan {{ results|length }} hasil</p>
        {% else %}
            <div class="alert alert-info text-center">
                <h4 class="mb-0">Tidak ditemukan hasil untuk pencarian "{{ request.GET.q }}"</h4>
            </div>
        {% endif %}
    {% else %}
        <div class="alert alert-info text-center">
            <h4 class="mb-0">Silakan masukkan kata kunci untuk pencarian</h4>
        </div>
    {% endif %}

    <div class="mt-3">
        <a href="{% url 'admin_dashboard' %}" class="btn btn-secondary">Kembali ke Dashboard</a>
    </div>
</div>
{% endblock %}